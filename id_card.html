<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1,user-scalable=no" />
  <title>Card | Ruiqian Zhang</title>
  
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:ital,opsz,wght@0,14..32,100..900;1,14..32,100..900&display=swap" rel="stylesheet">
  <link rel="icon" href="icons/face.svg" type="image/svg+xml">

  <style>
    :root {
      /* Colors */
      --bg: #f2f0ef;
      --text: #111;
      --muted: #6b7280;
      --accent: #861F41; /* Maroon */
      
      /* Dynamic UI Colors */
      --hover-bg: rgba(134, 31, 65, 0.06);
      --border: rgba(16, 24, 40, 0.06);
      
      /* Shadows */
      --btn-shadow: rgba(134, 31, 65, 0.08);
      --card-shadow: rgba(134, 31, 65, 0.3);
    }

    body.dark {
      --bg: #071221;
      --text: #f2f0ef;
      --muted: #98a6b3;
      --accent: #E5751F; /* Orange */
      
      /* Dark Overrides */
      --hover-bg: rgba(255, 255, 255, 0.06);
      --border: rgba(255, 255, 255, 0.06);
      
      /* Shadows */
      --btn-shadow: rgba(200, 200, 200, 0.18);
      --card-shadow: rgba(229, 117, 31, 0.75);
    }

    /* --- Base Layout --- */
    body {
      height: 100vh; 
      height: 100dvh; 
      margin: 0; padding: 0;
      overflow: hidden; /* Prevent Scrolling */
      
      font-family: 'Inter', sans-serif;
      background: var(--bg); color: var(--text);
      
      display: flex; 
      flex-direction: column;
      align-items: center; /* Center Horizontal */
      justify-content: center; /* Center Vertical */
      
      /* DEFAULT PADDING (Desktop) */
      box-sizing: border-box;
    }

    /* --- ID Card --- */
    .id-card-wrapper {
      perspective: 1000px; 
      width: 100%; max-width: 320px; 
      margin-bottom: 25px; /* Gap between card and buttons */
      transform-style: preserve-3d;
      z-index: 10;
    }

    .student-id {
      position: relative; width: 100%; aspect-ratio: 0.63;
      background: #fff; border-radius: 20px;
      border: 1px solid rgba(0,0,0,0.1); padding: 30px;
      box-sizing: border-box; display: flex; flex-direction: column; gap: 20px;
      overflow: hidden; transform-style: preserve-3d;
      background-image: radial-gradient(circle at 100% 0%, rgba(134, 31, 65, 0.08) 0%, transparent 30%);
      transition: transform 0.1s linear, box-shadow 0.1s linear;
    }
    body.dark .student-id { border-color: rgba(255,255,255,0.2); background-color: #fff; }

    /* Glare */
    .id-glare {
      position: absolute; top: 0; left: 0; width: 100%; height: 100%;
      border-radius: 20px; z-index: 20; pointer-events: none; opacity: 0;
      background: linear-gradient(125deg, transparent 40%, rgba(255,255,255,0.4) 50%, transparent 60%);
      background-size: 250% 250%; transition: opacity 0.2s ease;
    }

    /* Card Content */
    .id-header { display: flex; justify-content: space-between; border-bottom: 2px solid var(--accent); padding-bottom: 15px; transform: translateZ(20px); }
    .id-school-name { font-weight: 800; font-size: 18px; letter-spacing: 0.5px; text-transform: uppercase; color: var(--accent); }
    
    .id-body { display: flex; flex-direction: column; align-items: center; gap: 25px; flex-grow: 1; transform: translateZ(10px); }
    .id-photo-box {
      width: 140px; height: 170px; background: #f2f0ef;
      border: 1px solid var(--border); border-radius: 12px;
      overflow: hidden; display: flex; justify-content: center;
    }
    .id-photo-box img { width: 100%; height: 100%; object-fit: cover; opacity: 0.95; }

    .id-info { width: 100%; display: flex; flex-direction: column; gap: 10px; }
    .id-name { font-size: 24px; font-weight: 700; color: #111; text-align: center; margin: 0 0 10px 0; }
    
    .id-field { display: flex; justify-content: space-between; font-size: 14px; border-bottom: 1px dashed rgba(16,24,40,0.1); padding-bottom: 4px; }
    .id-label { color: #6b7280; font-weight: 500; font-size: 11px; text-transform: uppercase; }
    .id-value { color: #111; font-weight: 600; text-align: right; }

    .id-footer { margin-top: auto; padding-top: 10px; transform: translateZ(5px); }
    .barcode {
      height: 35px; width: 100%; opacity: 0.6;
      background: repeating-linear-gradient(90deg, #111 0, #111 2px, transparent 2px, transparent 5px, #111 5px, #111 7px, transparent 7px, transparent 10px);
    }

    /* --- Controls --- */
    .ui-container { display: flex; flex-direction: column; align-items: center; gap: 20px; z-index: 100; }
    .icon-row { display: flex; gap: 16px; }

    .icon-btn, .pill-accent {
      cursor: pointer; user-select: none; -webkit-tap-highlight-color: transparent;
      transition: transform 0.6s cubic-bezier(0.25, 1, 0.5, 1), background-color 0.3s ease, color 0.3s ease, box-shadow 0.3s ease;
    }

    .icon-btn {
      display: inline-flex; align-items: center; justify-content: center;
      width: 44px; height: 44px; border-radius: 8px; border: 0; background: transparent; color: var(--muted);
    }
    .icon-btn:active { transform: scale(0.95); background: var(--hover-bg); transition-duration: 0.1s; }

    .icon-mask {
      width: 16px; height: 16px; display: block;
      background-color: currentColor; 
      -webkit-mask-repeat: no-repeat; mask-repeat: no-repeat;
      -webkit-mask-position: center; mask-position: center;
      -webkit-mask-size: contain; mask-size: contain;
    }
    .back-icon { 
      width: 16px; height: 16px; display: block;
      -webkit-mask-image: url('icons/up_arrow.svg'); 
      mask-image: url('icons/up_arrow.svg'); 
      transform: rotate(-90deg); 
    }
    .home-icon { 
      width: 20px; height: 20px; display: block;
      -webkit-mask-image: url('icons/home.svg'); 
      mask-image: url('icons/home.svg'); 
    }

    .pill-accent {
      padding: 0 20px; height: 42px; background: var(--accent); color: white;
      border: none; border-radius: 999px; font-weight: 600; font-size: 14px;
      display: none; align-items: center; justify-content: center;
    }
    body.dark .pill-accent { color: var(--bg); }
    .pill-accent:active { opacity: 0.8; transform: scale(0.95); }

    @media (hover: hover) {
      .icon-btn:hover { 
        background: var(--hover-bg); color: var(--accent); 
        transform: translateY(-3px) scale(1.02); 
        box-shadow: 0 6px 18px var(--btn-shadow);
        transition: color 0s, transform 0.6s, box-shadow 0.3s;
      }
      .pill-accent:hover { 
        opacity: 0.95; transform: translateY(-3px) scale(1.02); 
        box-shadow: 0 6px 18px rgba(11,95,255,0.3); 
      }
      body.dark .pill-accent:hover { box-shadow: 0 8px 24px rgba(229,117,31,0.3); }
    }

    .theme-transition, .theme-transition * { 
      transition: background-color 0.32s ease, border-color 0.32s ease, color 0s, box-shadow 0.32s ease !important; 
    }

    .id-card-wrapper, .ui-container {
      opacity: 0; transform: none;
    }
    .page-loaded .id-card-wrapper, .page-loaded .ui-container { opacity: 1; transform: none; }

    /* --- MOBILE ADJUSTMENTS (Corrected) --- */
    @media (max-width: 768px) {
      body {
        /* This is the key fix. 
          By adding padding to the BOTTOM of the body, we lift the "center point"
          of the flex container. Both the Card and Buttons will shift UP together.
        */
        padding-bottom: 2vh;
        padding-left: 20px;
        padding-right: 20px;
      }

      .id-card-wrapper {
        /* Keep them close together */
        margin-bottom: 30px; 
      }
    }

  </style>
</head>
<body>

  <script>
    (function() {
      const saved = localStorage.getItem('theme');
      const prefersDark = window.matchMedia('(prefers-color-scheme: dark)').matches;
      document.body.style.transition = 'none';
      if (saved === 'dark' || (!saved && prefersDark)) document.body.classList.add('dark');
    })();
  </script>

  <div class="id-card-wrapper" id="id-wrapper">
    <div class="student-id" id="id-card">
      <div class="id-glare" id="id-glare"></div>
      <div class="id-header"><span class="id-school-name">Virginia Tech</span></div>
      
      <div class="id-body">
        <div class="id-photo-box"><img src="/Images/Ruiqian.jpg" alt="Profile"></div>
        <div class="id-info">
          <h3 class="id-name">Ruiqian Zhang</h3>
          <div class="id-field"><span class="id-label">Major:</span><span class="id-value">Electrical Engineering</span></div>
          <div class="id-field"><span class="id-label">GPA:</span><span class="id-value">3.89 / 4.0</span></div>
          <div class="id-field" style="border-bottom: none;"><span class="id-label">Expected:</span><span class="id-value">May 2028</span></div>
        </div>
      </div>
      <div class="id-footer"><div class="barcode"></div></div>
    </div>
  </div>

  <div class="ui-container">
    <div class="icon-row">
      <a href="projects.html" class="icon-btn square" aria-label="Go Back">
        <div class="icon-mask back-icon"></div>
      </a>
      <a href="index.html" class="icon-btn square" aria-label="Go to Home">
        <div class="icon-mask home-icon"></div>
      </a>
      <button id="theme-toggle" class="icon-btn square" aria-label="Toggle dark mode">
        <svg width="18" height="18" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
          <path d="M12 22C17.5228 22 22 17.5228 22 12C22 11.5373 21.3065 11.4608 21.0672 11.8568C19.9289 13.7406 17.8615 15 15.5 15C11.9101 15 9 12.0899 9 8.5C9 6.13845 10.2594 4.07105 12.1432 2.93276C12.5392 2.69347 12.4627 2 12 2C6.47715 2 2 6.47715 2 12C2 17.5228 6.47715 22 12 22Z" fill="currentColor"/>
        </svg>
      </button>
    </div>
    <button id="btn-motion" class="pill-accent" onclick="requestMotionPermission()">Click Me!</button>
  </div>

  <script>
    // --- State ---
    const UI = {
      wrapper: document.getElementById('id-wrapper'),
      card: document.getElementById('id-card'),
      glare: document.getElementById('id-glare'),
      btnMotion: document.getElementById('btn-motion'),
      themeBtn: document.getElementById('theme-toggle')
    };
    
    let motionActive = false;
    let target = { x: 0, y: 0 };

    // --- Init ---
    window.addEventListener('load', () => {
      setTimeout(() => document.body.style.transition = '', 100);
      requestAnimationFrame(() => document.body.classList.add('page-loaded'));
    });

    if ('ontouchstart' in window || navigator.maxTouchPoints > 0) {
      UI.btnMotion.style.display = 'inline-flex';
    }

    // --- Actions ---
    UI.themeBtn.addEventListener('click', () => {
      document.body.classList.add('theme-transition');
      const isDark = document.body.classList.toggle('dark');
      localStorage.setItem('theme', isDark ? 'dark' : 'light');
      setTimeout(() => document.body.classList.remove('theme-transition'), 420);
    });

    function updateCard(rx, ry, px, py) {
      UI.card.style.transform = `rotateX(${rx}deg) rotateY(${ry}deg)`;
      const shadowColor = getComputedStyle(document.body).getPropertyValue('--card-shadow');
      UI.card.style.boxShadow = `${-ry * 2}px ${rx * 2}px 30px ${shadowColor}`;
      UI.glare.style.opacity = '1';
      UI.glare.style.backgroundPosition = `${px * 100}% ${py * 100}%`;
    }

    function resetCard() {
      UI.card.style.transition = 'transform 0.5s ease, box-shadow 0.5s ease';
      UI.card.style.transform = 'rotateX(0) rotateY(0)';
      UI.card.style.boxShadow = 'none';
      UI.glare.style.opacity = '0';
    }

    // --- Mouse (Desktop) ---
    UI.wrapper.addEventListener('mousemove', e => {
      UI.card.style.transition = 'none'; 
      const rect = UI.wrapper.getBoundingClientRect();
      const pctX = (e.clientX - rect.left) / rect.width;
      const pctY = (e.clientY - rect.top) / rect.height;
      
      const maxRot = 12;
      updateCard((pctY - 0.5) * -2 * maxRot, (pctX - 0.5) * 2 * maxRot, pctX, pctY);
    });
    UI.wrapper.addEventListener('mouseleave', resetCard);

    // --- Gyro (Mobile) ---
    function requestMotionPermission() {
      if (typeof DeviceOrientationEvent?.requestPermission === 'function') {
        DeviceOrientationEvent.requestPermission()
          .then(s => s === 'granted' ? startMotion() : alert('Permission denied'))
          .catch(console.error);
      } else {
        startMotion();
      }
    }

    function startMotion() {
      window.addEventListener('deviceorientation', e => {
        if (e.beta === null) return;
        const max = 20;
        let rx = -(Math.min(Math.max((e.beta - 45), -max), max));
        let ry = Math.min(Math.max(e.gamma, -max), max);
        target = { x: rx, y: ry };
      });

      UI.btnMotion.style.display = 'none'; 
      motionActive = true;
      UI.card.style.transition = 'none';
      loop();
    }

    function loop() {
      if (!motionActive) return;
      const max = 20;
      updateCard(target.x, target.y, (target.y + max) / (max * 2), (-target.x + max) / (max * 2));
      requestAnimationFrame(loop);
    }
  </script>

</body>
</html>